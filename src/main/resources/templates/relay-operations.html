<!DOCTYPE html>
<html>
<head>
    <!-- Other head content... -->
</head>
<body>
<h1>Tor Relay Operations</h1>

<!-- Display guard configurations -->
<h2>Guard Relay Configurations</h2>
<ul>
    <li th:each="config : ${guardConfigs}">
        <!-- Display Guard relay configuration fields -->
        <p th:text="'Nickname: ' + ${config.guardRelayConfig.nickname}"></p>
        <p th:text="'ORPort: ' + ${config.guardRelayConfig.orPort}"></p>
        <p th:text="'Contact: ' + ${config.guardRelayConfig.contact}"></p>
        <p th:text="'Control Port: ' + ${config.guardRelayConfig.controlPort}"></p>
        <p>Status: <span th:id="${'status-' + config.guardRelayConfig.nickname}">Unknown</span></p>
        <span th:id="${'status-message-' + config.guardRelayConfig.nickname}" style="color: blue;">Idle</span>
        <!-- The data-config-type can be set statically if it is known, or dynamically if needed -->
        <button
                class="edit-button"
                th:data-config-nickname="${config.guardRelayConfig.nickname}"
                th:data-config-orport="${config.guardRelayConfig.orPort}"
                th:data-config-contact="${config.guardRelayConfig.contact}"
                th:data-config-controlport="${config.guardRelayConfig.controlPort}"
                th:attr="data-config-type='guard'"
        >
        Edit
        </button>
        <button class="remove-button"
                th:data-config-nickname="${config.guardRelayConfig.nickname}"
                th:data-config-type="guard">Remove</button>
        <button class="start-button" th:data-config-nickname="${config.guardRelayConfig.nickname}" th:attr="data-config-type='guard'">Start</button>
        <button class="stop-button" th:data-config-nickname="${config.guardRelayConfig.nickname}" th:attr="data-config-type='guard'">Stop</button>
    </li>
</ul>


<!-- Add modal for editing configurations (hidden by default) -->
<div id="edit-modal" class="modal">
    <div class="modal-content">
        <h2>Edit Configuration</h2>
        <form id="edit-form">
            <label for="edit-nickname">Nickname:</label>
            <input type="hidden" id="edit-nickname" name="edit-nickname">

            <label for="edit-orport">ORPort:</label>
            <input type="text" id="edit-orport" name="edit-orport">

            <label for="edit-server-transport">ServerTransportListenAddr:</label>
            <input type="text" id="edit-server-transport" name="edit-server-transport">

            <label for="edit-contact">Contact:</label>
            <input type="text" id="edit-contact" name="edit-contact">

            <label for="edit-controlport">Control Port:</label>
            <input type="text" id="edit-controlport" name="edit-controlport">

            <button type="button" id="save-button">Save</button>
            <button type="button" id="cancel-button">Cancel</button>
        </form>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="/js/edit.js"></script>
<script src="/js/status.js"></script>
<script src="/js/start.js"></script>
<script src="/js/stop.js"></script>
<script src="/js/remove.js"></script>
<script>
    function updateHostname() {
        fetch('/onion-service/current-hostname')
            .then(response => response.text())
            .then(hostname => {
                document.getElementById('hostname-display').textContent = hostname;
            })
            .catch(error => console.error('Error fetching hostname:', error));
    }

    // Update hostname every 10 seconds
    setInterval(updateHostname, 10000);

    // Initial call to set hostname on page load
    updateHostname();
</script>

</body>
</html>
